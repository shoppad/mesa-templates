{
    "key": "form/shopify_order_return",
    "name": "Enable Self-Service Returns with Forms",
    "version": "1.0.0",
    "enabled": false,
    "setup": false,
    "config": {
        "inputs": [
            {
                "schema": 2,
                "trigger_type": "input",
                "type": "form",
                "name": "Form",
                "key": "forms",
                "metadata": {
                    "form_data": [
                        {
                            "type": "header",
                            "subtype": "h1",
                            "label": "Return Your Order"
                        },
                        {
                            "type": "paragraph",
                            "subtype": "p",
                            "label": "We're sorry that you are returning your order."
                        },
                        {
                            "type": "hidden",
                            "name": "shopify_order_id",
                            "value": "{{ order.id }}"
                        },
                        {
                            "type": "radio-group",
                            "required": false,
                            "label": "Reason for your return",
                            "inline": false,
                            "name": "reason",
                            "other": true,
                            "values": [
                                {
                                    "label": "Purchased the wrong item",
                                    "value": "Purchased the wrong item",
                                    "selected": true
                                },
                                {
                                    "label": "Received the wrong item",
                                    "value": "Received the wrong item"
                                },
                                {
                                    "label": "Item arrived too late",
                                    "value": "Item arrived too late"
                                },
                                {
                                    "label": "Item was damaged or defective",
                                    "value": "Item was damaged or defective"
                                }
                            ]
                        }
                    ]
                },
                "local_fields": [],
                "on_error": "default",
                "weight": 0
            }
        ],
        "outputs": [
            {
                "schema": 3.1,
                "trigger_type": "output",
                "type": "shopify",
                "entity": "shop",
                "action": "list",
                "name": "Retrieve Shop",
                "key": "shopify",
                "operation_id": "get_shop",
                "metadata": {
                    "api_endpoint": "get admin\/shop.json"
                },
                "local_fields": [],
                "selected_fields": [],
                "on_error": "default",
                "weight": 0
            },
            {
                "schema": 3,
                "trigger_type": "output",
                "type": "shopify",
                "entity": "order",
                "action": "retrieve",
                "name": "Retrieve Order",
                "key": "shopify_order",
                "metadata": {
                    "order_id": "{{forms.shopify_order_id}}"
                },
                "local_fields": [],
                "on_error": "default",
                "weight": 1
            },
            {
                "schema": 4.1,
                "trigger_type": "output",
                "type": "googlesheets",
                "entity": "row",
                "action": "create",
                "name": "Add Row",
                "version": "v2",
                "key": "googlesheets",
                "operation_id": "record_create",
                "metadata": {
                    "api_endpoint": "post \/{spreadsheet_id}\/{sheet}",
                    "columns": [
                        "Order Name",
                        "Created At",
                        "Total Price",
                        "Reason for Return"
                    ],
                    "body": {
                        "columns": {
                            "A": "{{shopify_order.name}}",
                            "B": "{{shopify_order.created_at}}",
                            "C": "{{shopify_order.total_price}}",
                            "D": "{{forms.reason}}"
                        }
                    }
                },
                "local_fields": [
                    {
                        "key": "body",
                        "type": "object",
                        "fields": [
                            {
                                "key": "columns",
                                "type": "object",
                                "fields": [
                                    {
                                        "key": "A",
                                        "label": "Order Name",
                                        "type": "text",
                                        "location": "required"
                                    },
                                    {
                                        "key": "B",
                                        "label": "Created At",
                                        "type": "text",
                                        "location": "required"
                                    },
                                    {
                                        "key": "C",
                                        "label": "Total Price",
                                        "type": "text",
                                        "location": "required"
                                    },
                                    {
                                        "key": "D",
                                        "label": "Reason for Return",
                                        "type": "text",
                                        "location": "required"
                                    }
                                ],
                                "location": "required"
                            }
                        ],
                        "location": "required"
                    }
                ],
                "selected_fields": [],
                "on_error": "replay",
                "weight": 2
            },
            {
                "schema": 2,
                "trigger_type": "output",
                "type": "email",
                "version": "v1",
                "name": "Customer Email",
                "key": "email",
                "metadata": {
                    "to": "{{shopify_order.email}}",
                    "subject": "Your return for order {{shopify_order.name}}",
                    "message": "Hello {{shopify_order.customer.first_name}},\n\nWe're sorry that you had an issue with your order. We are working on initiating a return for the following products and will reach out shortly with next steps.\n\nThank you,\nThe {{shopify.name}} Team"
                },
                "local_fields": [],
                "on_error": "default",
                "weight": 2
            },
            {
                "schema": 2,
                "trigger_type": "output",
                "type": "slack",
                "version": "v2",
                "name": "Send Message",
                "key": "slack",
                "metadata": {
                    "message": "New Return:\n\nOrder: {{shopify_order.name}}\nAmount: {{shopify_order.total_price}}\nReason: {{forms.reason}}"
                },
                "local_fields": [],
                "on_error": "default",
                "weight": 3
            }
        ],
        "storage": []
    }
}
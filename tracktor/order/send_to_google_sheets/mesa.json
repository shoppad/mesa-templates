{
    "key": "tracktor/order/send_to_google_sheets",
    "name": "Export Delivered Order and Fulfillment Details to Google Sheets",
    "version": "1.0.0",
    "enabled": false,
    "setup": false,
    "config": {
        "inputs": [
            {
                "schema": 2,
                "trigger_type": "input",
                "type": "tracktor",
                "entity": "fulfillment",
                "action": "fulfillment/delivered",
                "name": "Fulfillment Status is Delivered",
                "key": "tracktor",
                "operation_id": "fulfillment_delivered",
                "metadata": [],
                "local_fields": [],
                "selected_fields": [],
                "on_error": "default",
                "weight": 0
            }
        ],
        "outputs": [
            {
                "schema": 3.1,
                "trigger_type": "output",
                "type": "shopify",
                "entity": "order",
                "action": "retrieve",
                "name": "Retrieve Order",
                "key": "shopify",
                "operation_id": "get_orders_order_id",
                "metadata": {
                    "api_endpoint": "get admin/orders/{{order_id}}.json",
                    "order_id": "{{tracktor.order_id}}"
                },
                "local_fields": [],
                "selected_fields": [],
                "on_error": "default",
                "weight": 0
            },
            {
                "schema": 4.2,
                "trigger_type": "output",
                "type": "googlesheets",
                "entity": "row",
                "action": "create",
                "name": "Add Row - Fulfillments",
                "version": "v2",
                "key": "googlesheets",
                "operation_id": "record_create",
                "metadata": {
                    "api_endpoint": "post /{spreadsheet_id}/{sheet}",
                    "columns": [
                        "Order ID",
                        "Order Name (number)",
                        "Order Email",
                        "Order Phone",
                        "Tracking Number",
                        "Tracking Company",
                        "Shipping Country",
                        "Shipment Status",
                        "Created At (date and time)",
                        "Delivery Date (and time)",
                        "Tracking URL",
                        "Days since Ordered"
                    ],
                    "body": {
                        "columns": {
                            "A": "{{shopify.id}}",
                            "B": "{{shopify.name}}",
                            "C": "{{shopify.email}}",
                            "D": "{{shopify.customer.phone}}",
                            "E": "{{tracktor.tracking_number}}",
                            "F": "{{tracktor.carrier.name}}",
                            "G": "{{shopify.billing_address.country}}",
                            "H": "{{tracktor.shipment_status}}",
                            "I": "{{shopify.created_at}}",
                            "J": "{{tracktor.latest_status.datetime}}",
                            "K": "{{tracktor.shop_url}}/apps/tracktor/track?order={{tracktor.order_name | url_encode }}&email={{shopify.email}}"
                        }
                    }
                },
                "local_fields": [
                    {
                        "key": "body",
                        "type": "object",
                        "fields": [
                            {
                                "key": "columns",
                                "type": "object",
                                "fields": [
                                    {
                                        "key": "A",
                                        "label": "Order ID",
                                        "type": "text"
                                    },
                                    {
                                        "key": "B",
                                        "label": "Order Name (number)",
                                        "type": "text"
                                    },
                                    {
                                        "key": "C",
                                        "label": "Order Email",
                                        "type": "text"
                                    },
                                    {
                                        "key": "D",
                                        "label": "Order Phone",
                                        "type": "text"
                                    },
                                    {
                                        "key": "E",
                                        "label": "Tracking Number",
                                        "type": "text"
                                    },
                                    {
                                        "key": "F",
                                        "label": "Tracking Company",
                                        "type": "text"
                                    },
                                    {
                                        "key": "G",
                                        "label": "Shipping Country",
                                        "type": "text"
                                    },
                                    {
                                        "key": "H",
                                        "label": "Shipment Status",
                                        "type": "text"
                                    },
                                    {
                                        "key": "I",
                                        "label": "Created At (date and time)",
                                        "type": "text"
                                    },
                                    {
                                        "key": "J",
                                        "label": "Delivery Date (and time)",
                                        "type": "text"
                                    },
                                    {
                                        "key": "K",
                                        "label": "Tracking URL",
                                        "type": "text"
                                    },
                                    {
                                        "key": "L",
                                        "label": "Days since Ordered",
                                        "type": "text"
                                    }
                                ],
                                "location": "required"
                            }
                        ],
                        "location": "required"
                    }
                ],
                "selected_fields": [],
                "on_error": "replay",
                "weight": 1
            },
            {
                "schema": 2,
                "trigger_type": "output",
                "type": "custom",
                "name": "Custom Code",
                "key": "custom",
                "operation_id": "custom",
                "metadata": {
                    "description": "Goes through each fulfillment in the order and checks if each fulfillment is fulfilled and requires shipping. The automation stops if these conditions are not met.",
                    "script": "custom.js"
                },
                "local_fields": [],
                "selected_fields": [],
                "on_error": "default",
                "weight": 2
            },
            {
                "schema": 4.2,
                "trigger_type": "output",
                "type": "googlesheets",
                "entity": "row",
                "action": "create",
                "name": "Add Row - Orders",
                "version": "v2",
                "key": "googlesheets_1",
                "operation_id": "record_create",
                "metadata": {
                    "api_endpoint": "post /{spreadsheet_id}/{sheet}",
                    "columns": [
                        "Order ID",
                        "Order Name (number)",
                        "Order Email",
                        "Customer First Name",
                        "Customer Last Name",
                        "Customer Full Name",
                        "Customer Email",
                        "Total Price",
                        "Shipping Address 1",
                        "Shipping Address 2",
                        "Shipping City",
                        "Shipping Zip",
                        "Shipping Province",
                        "Shipping Country",
                        "Created At (date and time)",
                        "Tracking URL"
                    ],
                    "body": {
                        "columns": {
                            "A": "{{shopify.id}}",
                            "B": "{{shopify.name}}",
                            "C": "{{shopify.email}}",
                            "D": "{{shopify.customer.first_name}}",
                            "E": "{{shopify.customer.last_name}}",
                            "F": "{{shopify.customer.default_address.name}}",
                            "G": "{{shopify.customer.email}}",
                            "H": "{{shopify.total_price}}",
                            "I": "{{shopify.shipping_address.address1}}",
                            "J": "{{shopify.shipping_address.address2}}",
                            "K": "{{shopify.shipping_address.city}}",
                            "L": "{{shopify.shipping_address.zip}}",
                            "M": "{{shopify.shipping_address.province}}",
                            "N": "{{shopify.shipping_address.country}}",
                            "O": "{{shopify.created_at}}",
                            "P": "{{tracktor.shop_url}}/apps/tracktor/track?order={{tracktor.order_name | url_encode }}&email={{shopify.email}}"
                        }
                    }
                },
                "local_fields": [
                    {
                        "key": "body",
                        "type": "object",
                        "fields": [
                            {
                                "key": "columns",
                                "type": "object",
                                "fields": [
                                    {
                                        "key": "A",
                                        "label": "Order ID",
                                        "type": "text",
                                        "location": "required"
                                    },
                                    {
                                        "key": "B",
                                        "label": "Order Name (number)",
                                        "type": "text",
                                        "location": "required"
                                    },
                                    {
                                        "key": "C",
                                        "label": "Order Email",
                                        "type": "text",
                                        "location": "required"
                                    },
                                    {
                                        "key": "D",
                                        "label": "Customer First Name",
                                        "type": "text",
                                        "location": "required"
                                    },
                                    {
                                        "key": "E",
                                        "label": "Customer Last Name",
                                        "type": "text",
                                        "location": "required"
                                    },
                                    {
                                        "key": "F",
                                        "label": "Customer Full Name",
                                        "type": "text",
                                        "location": "required"
                                    },
                                    {
                                        "key": "G",
                                        "label": "Customer Email",
                                        "type": "text",
                                        "location": "required"
                                    },
                                    {
                                        "key": "H",
                                        "label": "Total Price",
                                        "type": "text",
                                        "location": "required"
                                    },
                                    {
                                        "key": "I",
                                        "label": "Shipping Address 1",
                                        "type": "text",
                                        "location": "required"
                                    },
                                    {
                                        "key": "J",
                                        "label": "Shipping Address 2",
                                        "type": "text",
                                        "location": "required"
                                    },
                                    {
                                        "key": "K",
                                        "label": "Shipping City",
                                        "type": "text",
                                        "location": "required"
                                    },
                                    {
                                        "key": "L",
                                        "label": "Shipping Zip",
                                        "type": "text",
                                        "location": "required"
                                    },
                                    {
                                        "key": "M",
                                        "label": "Shipping Province",
                                        "type": "text",
                                        "location": "required"
                                    },
                                    {
                                        "key": "N",
                                        "label": "Shipping Country",
                                        "type": "text",
                                        "location": "required"
                                    },
                                    {
                                        "key": "O",
                                        "label": "Created At (date and time)",
                                        "type": "text",
                                        "location": "required"
                                    },
                                    {
                                        "key": "P",
                                        "label": "Tracking URL",
                                        "type": "text",
                                        "location": "required"
                                    }
                                ],
                                "location": "required"
                            }
                        ],
                        "location": "required"
                    }
                ],
                "selected_fields": [],
                "on_error": "replay",
                "weight": 3
            }
        ]
    }
}
